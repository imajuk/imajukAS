package com.imajuk.ui.scroll{    import com.imajuk.ui.IUIView;
    import flash.display.Sprite;    import flash.display.DisplayObject;    import org.libspark.thread.Thread;    /**     * @author shin.yamaharu     */    public class ScrollContentPositionThread extends Thread     {        private var bar:IUIView;        private var container:IScrollContainer;        private var move:Thread;        private var currentDestination:int = 0;        private var caluculator:ScrollCaluculator;        private var model : UIScrollBarModel;        public function ScrollContentPositionThread(                                    bar:IUIView,                                    container:IScrollContainer,                                    model:UIScrollBarModel                        )        {            super();            this.container = container;            this.bar = bar;            this.model = model;            var c:DisplayObject = container.content;            if (c is Sprite && Sprite(c).numChildren == 0)            	throw new Error("! WARNIG IScrollContainerに何もコンテンツが含まれていないようです");            	            caluculator =                 new ScrollCaluculator(                    model.barSpace,                     container.contentMask.rectangle.height + container.contentMask.rectangle.y,                    container.actualHeight                );        }        override protected function run():void        {            if(isInterrupted)                return;                        next(run);            
            var destination : int = caluculator.getDestination(bar.y - model.destMin);                                    if (currentDestination != destination)            {                currentDestination = destination;                                if (move)                    move.interrupt();                                    move = new MovingThread(container, destination);                move.start();            }        }        override protected function finalize():void        {        	if (move)                move.interrupt();                //            Logger.debug(this);        }    }}