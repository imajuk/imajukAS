package com.imajuk.slideshow{    import flash.display.Sprite;    import org.libspark.thread.Thread;    /**     * @author shinyamaharu     */    public class FadeImageSlideshowThread extends Thread     {        protected var imageContainer : Sprite;        protected var slideshow : Thread = new Thread();        protected var index : int = 0;        protected var sid : String;        protected var loop : Boolean;        protected var duration : Number;        protected var waitTime : Number;        protected var changeImageCallBack : Function;        protected var brightness : Number;        /**         * @param identify          このスライドショーを識別するための識別子         * @param imageContainer    スライドとなるDisplayObjectが格納されているコンテナ         * @param loop              ループするかどうか         */        public function FadeImageSlideshowThread(                            identify:String,                             imageContainer : Sprite,                             loop:Boolean = true,                            duration:Number = 1,                            waitTime:Number = 2.5,                            changeImageCallBack:Function = null,                            defaultIndex:int = 0,                            brightness:Number = NaN                        )        {            super();            this.sid = identify;            this.imageContainer = imageContainer;            this.loop = loop;            this.index = defaultIndex;                        if (duration > waitTime)                throw new Error("waitTimeをdurationより短くすることはできません");                            this.duration = duration;            this.waitTime = waitTime;            this.changeImageCallBack = changeImageCallBack;            this.brightness = brightness;        }        override protected function run() : void        {        	if (isInterrupted) return;            interrupted(function():void{});                        if (changeImageCallBack != null)                changeImageCallBack(index);            slideshow = new FadeImageContainerThread(sid, imageContainer, index, duration, duration, null, null, brightness);            slideshow.start();                        index ++;                        if (index >= imageContainer.numChildren)            {                if (loop)                   index = 0;                else                   return;            }                           sleep(waitTime * 1000);                        next(run);        }        override protected function finalize() : void        {        	slideshow.interrupt();        }    }}